---
title: Create an Admin Panel
---

<Steps>

### 1) Protect routes with roles

<Tabs>
<Tabs.Tab title="App Router">

```tsx
import { guard } from '@keyloom/nextjs'
export const metadata = { title: 'Admin' }
export default async function Page() {
  await guard({ visibility: 'role:admin', org: 'required', redirectTo: '/sign-in' })
  return (
    <div className="p-6">
      <h1 className="text-2xl font-semibold">Admin</h1>
      <p className="text-muted-foreground">Restricted area for admins.</p>
    </div>
  )
}
```

</Tabs.Tab>
<Tabs.Tab title="Pages Router">

Use middleware and/or server-side checks in API routes to enforce admin-only access. A simple page-side check:

```tsx
import { getSession } from '@keyloom/nextjs'
export default async function Page() {
  const { user } = await getSession()
  if (!user) return <div>Unauthorized</div>
  return <div className="p-6">Admin</div>
}
```

</Tabs.Tab>
</Tabs>

---

### 2) Build admin UI

- User management: list users, view roles, reset 2FA.
- Organization/team management: invites, role assignment, membership status.
- Audit/activity: render recent auth events and org changes.

Use components from `@keyloom/ui/org` for OrgSwitcher, MembersTable, and InviteMemberDialog.

---

### 3) Troubleshooting

- 403 on admin page: Ensure the viewer has the `admin` role in the active organization.
- Redirect loops: Confirm middleware does not mark admin routes as public.

</Steps>

