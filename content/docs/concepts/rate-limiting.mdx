---
title: Rate Limiting
---

Keyloom focuses on authentication primitives and plays well with your chosen rate limiter.

## Recommended approaches

- Middleware-level limits for auth endpoints (e.g., `/api/auth/*`) to throttle brute-force attempts
- Per-IP and per-identifier (email) caps for sensitive flows like forgot/reset password
- Sliding-window or token-bucket strategies with Redis or edge KV stores

## Example (middleware sketch)

```ts
// pseudo-code: integrate your limiter in Next.js middleware
import { limiter } from '@/lib/limiter';

export { default } from '@keyloom/nextjs/middleware';
export const config = { matcher: ['/api/auth/:path*'] };

export async function middleware(req: Request) {
  const key = `auth:${req.headers.get('x-forwarded-for') ?? 'ip'}`;
  const ok = await limiter.consume(key);
  if (!ok) return new Response('Too Many Requests', { status: 429 });
  // fall through to Keyloom middleware
}
```

Keep limits strict for credential endpoints and more lenient for idempotent reads.

