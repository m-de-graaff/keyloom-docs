---
title: API
---

Keyloom exposes HTTP handlers you mount in your Next.js app. These handlers implement CSRF protection, session issuance, OAuth callbacks, and more.

## Handlers

- App Router: export a route handler from `app/api/auth/[...keyloom]/route.ts`
- Pages Router: export a default handler from `pages/api/auth/[...keyloom].ts`

Routes are automatically multiplexed by the handler (sign-in/out, callback, CSRF, verification, etc.). You should not manually expose internal subroutes.

## Example (App Router)

```ts
import { createNextHandler } from '@keyloom/nextjs';
import config from '@/keyloom.config';

export const { GET, POST } = createNextHandler(config);
```

## Example (Pages Router)

```ts
import { createPagesApiHandler } from '@keyloom/nextjs';
import config from '@/keyloom.config';

export default createPagesApiHandler(config);
```

## CSRF

- Enabled by default for state-changing POSTs
- No need to whitelist CSRF routes in middleware
- Tokens are bound to session or anonymous cookie and rotated

## Errors

Handlers return typed errors with appropriate HTTP status codes. Use the browser console or server logs when debugging. See Tutorials for end-to-end examples.

