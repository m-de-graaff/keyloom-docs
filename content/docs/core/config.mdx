---
title: Configuration
description: Full configuration reference for defineKeyloom - sessions, cookies, providers, adapters, and RBAC.
---

# Configuration

Keyloom is configured via `defineKeyloom`.

```ts title="keyloom.config.ts"
import { defineKeyloom, memoryAdapter } from "@keyloom/core";

export default defineKeyloom({
  baseUrl: process.env.NEXT_PUBLIC_APP_URL ?? "http://localhost:3000",
  session: { strategy: "database", ttlMinutes: 60, rolling: true },
  adapter: memoryAdapter(),
  providers: [],
  rbac: { enabled: false },
  cookie: { name: "keyloom", sameSite: "lax", secure: true, path: "/" },
  secrets: { authSecret: process.env.AUTH_SECRET ?? "dev-secret" },
});
```

## Options

- `baseUrl: string`
  - External URL of your app used for OAuth callbacks and links
- `session`
  - `strategy: "jwt" | "database"`
  - `ttlMinutes: number` - session time to live
  - `rolling: boolean` - refresh expiration on activity
- `cookie`
  - `name: string` - cookie name
  - `path: string` - default "/"
  - `sameSite: "lax" | "strict" | "none"`
  - `secure: boolean` - set true in production HTTPS
  - `domain?: string`
- `providers: Provider[]` - OAuth/OpenID providers
- `adapter: Adapter` - required for database sessions
- `rbac`
  - `enabled: boolean`
  - `defaultRole?: string`
  - `roles?: Record<string, string[]>` - role to permission keys
- `secrets`
  - `authSecret: string` - secret for encryption or signing

## Environment variables

Recommended:

- `AUTH_SECRET`
- `NEXT_PUBLIC_APP_URL`
- Provider specific secrets such as `GITHUB_CLIENT_ID`, `GITHUB_CLIENT_SECRET`

## Strategy selection

- `jwt` - stateless, edge friendly, simple horizontal scaling
- `database` - central revocation, introspection, server sided invalidation

## Error handling

Most methods throw typed errors with a `code` and `message`. Handle at integration boundaries:

```ts
try {
  // sign in
} catch (err: any) {
  if (err.code === "OAUTH_CALLBACK_ERROR") {
    // show friendly message
  }
}
```

## Migration tips

- Start with `memoryAdapter` in development
- Switch to your DB adapter before production
- When moving from `jwt` to `database`, ensure middleware and server utilities are updated to read server sessions

