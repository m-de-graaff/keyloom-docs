---
title: CSRF Errors
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Steps, Step } from 'fumadocs-ui/components/steps';

A 403 on POST requests usually indicates a missing or invalid CSRF token.

<Steps>

### 1) Mount the shared API handler

Ensure the Keyloom API route is mounted so `/api/auth/csrf` is available.

### 2) Fetch the CSRF token before POST

```ts
// GET /api/auth/csrf then include hidden input named `csrf`
```

### 3) Include the token in your form

Hidden field must be named `csrf` and sent with the POST body.

### 4) Check cookies and domain

CSRF binds to a cookie. Verify `NEXT_PUBLIC_APP_URL` and cookie domain/secure flags are correct for your environment.

</Steps>

<Callout>
Do not disable CSRF. If calling the API with `fetch`, include `credentials: 'include'` so cookies are sent.
</Callout>

