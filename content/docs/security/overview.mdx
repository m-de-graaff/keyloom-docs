---
title: Security
description: Security model and best practices - cookies, JWT, OAuth, and CSRF.
---

# Security

Keyloom provides a secure baseline and flexible options. This page summarizes the model and best practices.

## Cookies

- Set `secure: true` in production and use HTTPS
- Prefer `sameSite: lax` for app UIs; use `none` only when needed for cross-site flows
- Use `domain` and `path` to scope tokens if you host multiple apps

## JWT strategy

- Stateless verification using `authSecret` or JWKS
- Good fit for edge runtimes and horizontal scaling
- Consider short TTLs with rolling sessions for better UX

## Database strategy

- Server-side session store via adapter
- Supports invalidation and introspection
- Use when you need central control or long-lived sessions

## OAuth providers

- Use `state` and PKCE where supported
- Rotate client secrets and limit scopes
- Host callback endpoints on HTTPS only

## CSRF

- For Cookie-based APIs, prefer same-site cookies and CSRF tokens for unsafe methods
- Middleware helps ensure protected routes require a valid session

## Recommended production settings

- `cookie.secure: true`
- `cookie.sameSite: "lax"`
- Distinct `AUTH_SECRET` per environment
- Use HTTPS and HSTS
- Limit provider scopes to what you need

